# encoding: UTF-8
require 'bundler/gem_tasks'
require 'rake/testtask'
require 'rdoc/task'

desc 'Default: run tests'
task :default => ['nimbleshop_core:test_full']
task :test => ['nimbleshop_core:test_full']

namespace :nimbleshop_core do

  task :test_full do
    p = File.expand_path('../test/myshop', __FILE__)
    cmd = "cd #{p} && rake db:migrate && rake db:test:prepare"
    sh cmd

    Rake::Task["nimbleshop_core:test"].invoke
  end

  desc 'Run nimbleshop_core tests.'
  Rake::TestTask.new(:test) do |t|
    t.libs << 'lib'
    t.libs << 'test'
    t.pattern = 'test/**/*_test.rb'
    t.verbose = true
  end

end
